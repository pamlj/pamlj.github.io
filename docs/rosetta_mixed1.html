<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>Mixed vs RM-ANOVA</title>

        <script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
            $(".toc-details" > a).on("click", function(e) {
                window.scrollBy(0, 100);
            })
                  return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-LLVCE05YX9');
        </script>
    
    
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="ttest.html">t-test</a>
      </li>
      <li>
        <a href="correlation.html">Correlation</a>
      </li>
      <li>
        <a href="prop.html">Proportions</a>
      </li>
      <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="factorial.html">Factorial</a>
      </li>
      <li>
        <a href="mediation.html">Mediation</a>
      </li>
      <li>
        <a href="sem.html">SEM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed Models</a>
      </li>
      <li>
        <a href="rosetta.html">Rosetta</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/pamlj/pamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Mixed vs RM-ANOVA</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Mixed vs RM-ANOVA</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#rm-avova" id="toc-rm-avova">RM-AVOVA</a></li>
      <li><a href="#mixed-model" id="toc-mixed-model">Mixed
      model</a></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      <li><a href="#references" id="toc-references">References</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div class="version">
<p>0.8.0</p>
</div>
<p>Comparing software results in power analysis for mixed models is not
straightforward. Only a few programs support this type of analysis, and
those that do often implement different procedures. Here we compare
equivalent designs using power analyses based on different statistical
tests. The goal is to examine whether analyses conducted with different
approaches yield similar power estimates.</p>
<p>Specifically, we compare the required sample size estimated via
repeated-measures ANOVA with that obtained from mixed-model power
analysis. We use a simulated dataset that produces equivalent results
under both ANOVA and mixed models, and we show that the corresponding
power analyses converge to similar conclusions.</p>
<div id="rm-avova" class="section level1">
<h1>RM-AVOVA</h1>
<p>The data mimic a repeated-measures design, with time as a categorical
independent variable with four levels and a continuous dependent
variable. To analyze them with repeated-measures ANOVA, we require a
wide-format dataset, with one row per participant and the following
structure:</p>
<p><img src="rosetta/pics/mixed/r1.data.1.png" width="590" /></p>
<p>The repeated-measure ANOVA has one categorical variable
(<em>time</em>) measured over 4 times. The dependent variable is a
continuous variables. Based the RM-ANOVA on a sample of 50 cases, we
obtain a partial eta-squared <span
class="math inline">\(\eta_p^2=.115\)</span>.</p>
<p><img src="rosetta/pics/mixed/output.rm.1.png" width="603" /></p>
<p>With this information, we estimated the required sample size to
obtain a power of at least .90 using <span
class="modulename">PAMLj</span> <code>Factorial Designs</code>
command.</p>
<p><img src="rosetta/pics/mixed/input.rm.2.png" width="583" /></p>
<p>obtaining a sample size of <span
class="math inline">\(N=39\)</span>.</p>
<p><img src="rosetta/pics/mixed/output.rm.2.png" width="615" /></p>
<p>With the original <span class="math inline">\(N=50\)</span> cases,
the expected power would be <span
class="math inline">\(1-\beta=.965\)</span>.</p>
<p><img src="rosetta/pics/mixed/output.rm.3.png" width="620" /></p>
</div>
<div id="mixed-model" class="section level1">
<h1>Mixed model</h1>
<p>The same data, in long format, were analyzed with a mixed model, with
<em>time</em> as factor, coded with <code>deviation</code> coding
(0’s,-1, and 1’s), and random intercept across participants. Results
showed the same F-test of the RM-ANOVA, but give us the coefficients for
the contrast variables and the random coefficients variances required to
set up the power analysis model.</p>
<p><img src="rosetta/pics/mixed/output.lme.1.png" width="714" /></p>
<p>So, the RM-ANOVA results are equivalent to a mixed model with three
contrast variables representing <em>time</em>, with coefficients <span
class="math inline">\(.5052\)</span>,<span
class="math inline">\(-.2952\)</span>, and <span
class="math inline">\(-.0043\)</span>. The random intercept variance was
<span class="math inline">\(\sigma_I^2=.00863\)</span> and the residual
variance <span class="math inline">\(\sigma^2=1.009\)</span>. We can
plug these values in the mixed model power analysis command.</p>
<p><img src="rosetta/pics/mixed/input.lme.2.png" width="562" /></p>
<p>First, we use the <code>squared-brackets</code> syntax to attach
three coefficients to the corresponding contrast variables representing
<em>time</em>. Second, we multiply the random intercept (<code>1</code>)
by the expected variance (<span class="math inline">\(.0083\)</span>).
This way, we pass the expected coefficients required to build the mixed
model for simulating power and finding the required N.</p>
<p>Because in this model participants are the clusters of the model, we
set <code>Calculate: N</code> as aim and
<code>Number of cluster levels</code> as specific aim.</p>
<p><img src="rosetta/pics/mixed/input.lme.3.png" width="469" /></p>
<p>We then specify in the <span class="option"> <b>Model Structure
</b></span> -&gt; <span class="option"> <b>Clustering vriables
</b></span> that the variable <em>id</em> (the participants) has
<code>N per cluster</code> equal to 4, because within each participant
there will be 4 repeated measures.</p>
<p>Then, we specify that the variable <em>time</em> is a categorical
variable with 4 levels.</p>
<p><img src="rosetta/pics/mixed/input.lme.4.png" width="560" /></p>
<p>Finally, we set the residual variance of the model to <span
class="math inline">\(1.009\)</span> as we found in the mixed model.</p>
<p><img src="rosetta/pics/mixed/input.lme.5.png" width="363" /></p>
<p>Running the analysis yield a required N
(<code>Cluster levels</code>=number of participants) of 39, as expected
by the RM-ANOVA power analysis. Because the mixed model power analysis
is based on Monte Carlo simulations, different runs may yield slightly
different N, but the results substantially converge.</p>
<p><img src="rosetta/pics/mixed/output.lme.2.png" width="647" /></p>
<p>As an additional check, we compute the expected power of the mixed
model test of time based on the original 50 participants. We get <span
class="math inline">\(1-\beta=.967\)</span>, remarkably similar to the
one obtained with the RM-ANOVA power analysis (<span
class="math inline">\(1-\beta=.966\)</span>)</p>
<p><img src="rosetta/pics/mixed/output.lme.3.png" width="736" /></p>
<p>Again, repeating the calculation yields slightly different results,
but all substantially congruent with the expected values.</p>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./rosetta.html">PAMLj: rosetta</a>
</div>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues " target="_blank"> PAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
