<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>Mediation: Simple models</title>

        <script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
            $(".toc-details" > a).on("click", function(e) {
                window.scrollBy(0, 100);
            })
                  return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-LLVCE05YX9');
        </script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="ttest.html">t-test</a>
      </li>
      <li>
        <a href="correlation.html">Correlation</a>
      </li>
      <li>
        <a href="prop.html">Proportions</a>
      </li>
      <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="factorial.html">Factorial</a>
      </li>
      <li>
        <a href="mediation.html">Mediation</a>
      </li>
      <li>
        <a href="sem.html">SEM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed Models</a>
      </li>
      <li>
        <a href="rosetta.html">Rosetta</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/pamlj/pamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Mediation: Simple models</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Mediation: Simple models</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#sobel-test" id="toc-sobel-test">Sobel test</a>
      <ul>
      <li><a href="#pamlj" id="toc-pamlj">PAMLj</a></li>
      <li><a href="#powermediation-package"
      id="toc-powermediation-package">powerMediation package</a></li>
      <li><a href="#pwrss-package" id="toc-pwrss-package">pwrss
      package</a></li>
      </ul></li>
      <li><a href="#joint-significance"
      id="toc-joint-significance">Joint significance</a>
      <ul>
      <li><a href="#pamlj-1" id="toc-pamlj-1">PAMLj</a></li>
      <li><a href="#other-software" id="toc-other-software">Other
      software</a></li>
      </ul></li>
      <li><a href="#monte-carlo" id="toc-monte-carlo">Monte Carlo</a>
      <ul>
      <li><a href="#pamlj-2" id="toc-pamlj-2">PAMLj</a></li>
      <li><a href="#pwrss" id="toc-pwrss">pwrss</a></li>
      <li><a href="#monte-carlo-power-analysis-mc_power_med"
      id="toc-monte-carlo-power-analysis-mc_power_med">Monte Carlo Power
      Analysis (mc_power_med)</a></li>
      </ul></li>
      <li><a href="#power-estimation" id="toc-power-estimation">Power
      estimation</a>
      <ul>
      <li><a href="#other-software-1" id="toc-other-software-1">Other
      software</a></li>
      </ul></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      <li><a href="#references" id="toc-references">References</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div class="version">
<p>0.4.0</p>
</div>
<p>Here we compare the results of <span class="modulename">PAMLj</span>
with other software that performs power analysis for mediation. In
particular, we will compare our results with <a
href="https://CRAN.R-project.org/package=pwrss">pwrss R package</a>, <a
href="https://schoemanna.shinyapps.io/mc_power_med/">Monte Carlo Power
Analysis</a> shiny app, and <a
href="https://cran.r-project.org/package=powerMediation">powerMediation
R package</a></p>
<ul>
<li><p><a href="https://CRAN.R-project.org/package=pwrss">pwrss R
package</a> provides desired power and required sample size based on
Sobel test and joint significance methods. It also provides desired
power based on simulations. The simulations are based on Monte Carlo
parametric re-sampling.</p></li>
<li><p><a href="https://schoemanna.shinyapps.io/mc_power_med/">Monte
Carlo Power Analysis</a> shiny app] provides desired power based on
simulations. The simulations are based on Monte Carlo semi-parametric
re-sampling.</p></li>
<li><p><a
href="https://cran.r-project.org/package=powerMediation">powerMediation
R package</a> provides power and sample size based on Sobel
test.</p></li>
</ul>
<p>Finally we also check some results with <a
href="https://CRAN.R-project.org/package=bmem">bmen R package</a>, which
employs a two-stage simulation approach. This package simulate samples,
and for each sample simulate a bootstrap test. This makes the
computation very time-consuming, despite it yields the same results of
the much faster parametric re-sampling.</p>
<p>As with any power analysis software comparison, results should be
considered equivalent when their values are very close, even if they do
not match exactly. This is because power parameters, such as effect
sizes and sample sizes, are often rounded or approximated. The exact
values may not correspond precisely across different software, but the
key consideration is that the results are practically the same and
provide similar insights for decision-making. Small differences in
output do not invalidate the analysis as long as they are within an
acceptable range.</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = Sample Size</li>
<li>Expected <span class="math inline">\(a\)</span> = .3</li>
<li>Expected <span class="math inline">\(b\)</span> = .3</li>
<li>Expected <span class="math inline">\(c&#39;\)</span> = .4</li>
<li>power = .80</li>
<li>Alpha = .05</li>
</ul>
</div>
<div id="sobel-test" class="section level1">
<h1>Sobel test</h1>
<div id="pamlj" class="section level3">
<h3>PAMLj</h3>
<p>In <span class="modulename">PAMLj</span> we set the parameters as
follows, using the <code>Sobel test</code>:</p>
<p><img src="rosetta/pics/mediation/input.2.png" width="570" /></p>
<p>Using the Sobel test method one obtains <span
class="math inline">\(N=144\)</span>:</p>
<p><img src="rosetta/pics/mediation/sobel.1.png" width="482" /></p>
</div>
<div id="powermediation-package" class="section level3">
<h3>powerMediation package</h3>
<p>In <code>powerMediation</code> the command to use is
<code>ssMediation.Sobel</code>. The required input are:</p>
<ul>
<li>theta.1a = a = .3</li>
<li>lambda.a = b = .3</li>
<li>sigma.x = 1 (standard deviation of x)</li>
<li>sigma.m = 1 (standard deviation of the mediator)</li>
<li>sigma.epsilon: this is the standard deviation error term of the
regression predicting the dependent variable. It is equivalent to</li>
</ul>
<p><span class="math display">\[ \sigma_{\epsilon}=\sqrt{1-R_{y}^2}
\]</span> where <span class="math inline">\(R_{y}^2\)</span> is the
R-squared in predicting the dependent variable with both the independent
variable and the mediator. We can compute it with:</p>
<p><span class="math display">\[ R_{y}^2=b^2+c&#39;^2+2abc&#39;
\]</span> which implies</p>
<p><span class="math display">\[
\sigma_{\epsilon}=\sqrt{1-(b^2+c&#39;^2+2abc&#39;)} \]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>a  <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>b  <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>cp <span class="ot">&lt;-</span> .<span class="dv">4</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>(b<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>cp<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b<span class="sc">*</span>cp))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>powerMediation<span class="sc">::</span><span class="fu">ssMediation.Sobel</span>(<span class="at">power =</span> .<span class="dv">80</span>,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                           <span class="at">theta.1a =</span> a,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                           <span class="at">lambda.a =</span> b,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                            <span class="at">sigma.x =</span> <span class="dv">1</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                            <span class="at">sigma.m =</span> <span class="dv">1</span>,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                      <span class="at">sigma.epsilon =</span> e)</span></code></pre></div>
<pre><code>## [1] 144.3366</code></pre>
<p>It is clear that the results concur with those produced by <span
class="modulename">PAMLj</span>.</p>
</div>
<div id="pwrss-package" class="section level3">
<h3>pwrss package</h3>
<p>In <code>pwrss</code> the command to use is
<code>pwrss.z.mediation</code>. The required input are:</p>
<ul>
<li>a = .3</li>
<li>b = .3</li>
<li>ry.mx: this is expected R-squared <span
class="math inline">\(R_y^2\)</span> in predicting the dependent
variable. Although <code>pwrss.z.mediation</code> accept <span
class="math inline">\(cp\)</span> (c prime) as input, it is more
accurate to pass the <span class="math inline">\(R_y^2\)</span>, which
incorporate the presence of <span class="math inline">\(c&#39;\)</span>.
In fact, as we have seen above:</li>
</ul>
<p><span class="math display">\[ R_{y}^2=b^2+c&#39;^2+2abc&#39;
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>a<span class="ot">&lt;-</span>.<span class="dv">3</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>b<span class="ot">&lt;-</span>.<span class="dv">3</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>cp<span class="ot">&lt;-</span>.<span class="dv">4</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>r2y<span class="ot">&lt;-</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>cp<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b<span class="sc">*</span>cp</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>pwrss<span class="sc">::</span><span class="fu">pwrss.z.mediation</span>(<span class="at">a=</span>a,<span class="at">b=</span>b,<span class="at">r2y.mx=</span>r2y,<span class="at">power=</span>.<span class="dv">80</span>,<span class="at">alpha=</span>.<span class="dv">05</span>)</span></code></pre></div>
<pre><code>##  Indirect Effect in a Mediation Model
##  ====================================
##   method non-centrality   n     power
##    Sobel       2.808013 145 0.8017955
##   Aroian       2.803974 149 0.8006690
##  Goodman       2.805152 140 0.8009979
##  ------------------------------------
##  Type 1 error rate: 0.05</code></pre>
<p>The Sobel test yields a required sample size of <span
class="math inline">\(N=145\)</span>, as the other software.</p>
</div>
</div>
<div id="joint-significance" class="section level1">
<h1>Joint significance</h1>
<div id="pamlj-1" class="section level3">
<h3>PAMLj</h3>
<p>In <span class="modulename">PAMLj</span> we set the parameters as
follows, using the <code>Sobel test</code>:</p>
<p><img src="rosetta/pics/mediation/input.2.png" width="570" /></p>
<p><img src="rosetta/pics/mediation/joint.1.png" width="506" /></p>
<p>The relevant parameter here is <span
class="math inline">\(N=95\)</span></p>
</div>
<div id="other-software" class="section level3">
<h3>Other software</h3>
<p>At present, I have not found any software that estimates the required
sample size (N) using the joint significance method. However, we can
work around this by using the <code>pwrss.z.mediation</code> function,
which calculates power for a given N. From there, we can iteratively
search for the N that provides the closest match to the required power,
effectively using a brute-force approach.</p>
<p>Here is an algorithm for that.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>a<span class="ot">&lt;-</span>.<span class="dv">3</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>b<span class="ot">&lt;-</span>.<span class="dv">3</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>cp<span class="ot">&lt;-</span>.<span class="dv">4</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>r2y<span class="ot">&lt;-</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>cp<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b<span class="sc">*</span>cp</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>power<span class="ot">&lt;-</span>.<span class="dv">80</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>ns<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">80</span>,<span class="dv">110</span>,<span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">lapply</span>(ns, <span class="cf">function</span>(n) <span class="fu">c</span>(n,pwrss<span class="sc">::</span><span class="fu">pwrss.z.mediation</span>(<span class="at">a=</span>a,<span class="at">b=</span>b,<span class="at">r2y.mx=</span>r2y,<span class="at">n=</span>n,<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">verbose=</span>F)<span class="sc">$</span>power[[<span class="st">&quot;joint&quot;</span>]]))</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind,results))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>data<span class="sc">$</span>dif<span class="ot">&lt;-</span><span class="fu">abs</span>(data<span class="sc">$</span>V2<span class="sc">-</span>power)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>data<span class="sc">$</span>V1[<span class="fu">which.min</span>(data<span class="sc">$</span>dif)]</span></code></pre></div>
<pre><code>## [1] 95</code></pre>
<p>Comfortably, the brute force method yields the same results as <span
class="modulename">PAMLj</span>.</p>
</div>
</div>
<div id="monte-carlo" class="section level1">
<h1>Monte Carlo</h1>
<div id="pamlj-2" class="section level3">
<h3>PAMLj</h3>
<p>In <span class="modulename">PAMLj</span> we set the parameters as
follows, using the <code>Monte Carlo</code> test:</p>
<p><img src="rosetta/pics/mediation/input.3.png" width="567" /></p>
<p>Because we are testing the module, we set a <span
class="option">seed</span> for the Monte Carlo simulation. We do this
only to ensure the reproducibility of the example; however, in everyday
analysis, this option should almost never be used.</p>
<p><img src="rosetta/pics/mediation/input.3.1.png" width="576" /></p>
<p>Using the Monte Carlo method one obtains (a part for random
variability) <span class="math inline">\(N=96\)</span>:</p>
<p><img src="rosetta/pics/mediation/mc.1.png" width="491" /></p>
</div>
<div id="pwrss" class="section level3">
<h3>pwrss</h3>
<p>As we did for the <code>joint significance</code> test, we can use
the <code>pwrss.z.mediation</code> function, which computes power for a
given N using the <code>Monte Carlo method</code> to search for the N
that yields the closest match to the required power.</p>
<p>Here is an algorithm for that (it can be slow).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>a<span class="ot">&lt;-</span>.<span class="dv">3</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>b<span class="ot">&lt;-</span>.<span class="dv">3</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>cp<span class="ot">&lt;-</span>.<span class="dv">4</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>r2y<span class="ot">&lt;-</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>cp<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b<span class="sc">*</span>cp</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>power<span class="ot">&lt;-</span>.<span class="dv">80</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>ns<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">80</span>,<span class="dv">110</span>,<span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">lapply</span>(ns, <span class="cf">function</span>(n) <span class="fu">c</span>(n,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                                  pwrss<span class="sc">::</span><span class="fu">pwrss.z.mediation</span>(<span class="at">a=</span>a,<span class="at">b=</span>b,<span class="at">r2y.mx=</span>r2y,<span class="at">n=</span>n,<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">mc=</span><span class="cn">TRUE</span>,<span class="at">nsims=</span><span class="dv">10000</span>,<span class="at">verbose=</span>F)<span class="sc">$</span>power[[<span class="st">&quot;mc&quot;</span>]]))</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind,results))</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>data<span class="sc">$</span>dif<span class="ot">&lt;-</span><span class="fu">abs</span>(data<span class="sc">$</span>V2<span class="sc">-</span>power)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>data<span class="sc">$</span>V1[<span class="fu">which.min</span>(data<span class="sc">$</span>dif)]</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co"># This section is not evaluated during the page compilation due to the time required for execution. The output is pre-computed, but it can be</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co"># verified that the results consistently appear in this manner. With nsims=10000, we expect minimal variability in the results. However, it appears # that pwrss does not honor the set.seed function for reproducibility.</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># Results are almost always 96-98</span></span></code></pre></div>
</div>
<div id="monte-carlo-power-analysis-mc_power_med"
class="section level3">
<h3>Monte Carlo Power Analysis (mc_power_med)</h3>
<p><a href="https://schoemanna.shinyapps.io/mc_power_med/">Monte Carlo
Power Analysis</a> is a Shiny app that computes power for mediated
effects using semi-parametric re-sampling. In each Monte Carlo sample, a
new dataset is randomly drawn from a population with the specified input
parameters, and the mediated effect is calculated along with the
standard error. For each sample, a distribution of possible parameters
is generated and its confidence intervals are evaluated. While Monte
Carlo Power Analysis does not directly solve for the required N, it
allows you to evaluate power across a range of N values. In this case,
we requested an evaluation of power with N ranging from 80 to 120, using
the parameters mentioned above.</p>
<p><img src="rosetta/pics/mediation/input.4.png" width="1119" /></p>
<p><img src="rosetta/pics/mediation/mc.2.png" width="579" /></p>
<p>Results, shown here in the vicinity of <span
class="math inline">\(power=.80\)</span> (4th column) shows that the
required N (2nd column) is around 96, congruent with the results of
<span class="modulename">PAMLj</span>.</p>
</div>
</div>
<div id="power-estimation" class="section level1">
<h1>Power estimation</h1>
<p>Now we check the results of <span class="modulename">PAMLj</span>
when the sample size is given and the required parameter is
<code>power</code>.</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = Sample Size</li>
<li>Expected <span class="math inline">\(a\)</span> = .2</li>
<li>Expected <span class="math inline">\(b\)</span> = .6</li>
<li>Expected <span class="math inline">\(c&#39;\)</span> = .2</li>
<li>N = 70</li>
<li>Alpha = .05</li>
</ul>
</div>
<p><img src="rosetta/pics/mediation/input.5.png" width="579" /></p>
<p>For <code>joint significance</code> method we obtain <span
class="math inline">\(power=.401\)</span>.</p>
<p><img src="rosetta/pics/mediation/joint.2.png" width="481" /></p>
<p>for <code>Sobel test</code> method we obtain <span
class="math inline">\(power=.381\)</span>.</p>
<p><img src="rosetta/pics/mediation/sobel.2.png" width="463" /></p>
<p>and for the <code>Monte Carlo</code> method we get <span
class="math inline">\(power=.402\)</span>.</p>
<p><img src="rosetta/pics/mediation/mc.3.png" width="493" /></p>
<div id="other-software-1" class="section level3">
<h3>Other software</h3>
<p>The <code>pwrss</code> package provides all three methods to estimate
expected power.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>a<span class="ot">&lt;-</span>.<span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>b<span class="ot">&lt;-</span>.<span class="dv">6</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>cp<span class="ot">&lt;-</span>.<span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>r2y<span class="ot">&lt;-</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>cp<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b<span class="sc">*</span>cp</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="dv">70</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>pwrss<span class="sc">::</span><span class="fu">pwrss.z.mediation</span>(<span class="at">a=</span>a,<span class="at">b=</span>b,<span class="at">r2y.mx=</span>r2y,<span class="at">n=</span>N,<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">mc=</span><span class="cn">TRUE</span>,<span class="at">nsims=</span><span class="dv">10000</span>,<span class="at">verbose=</span>T)</span></code></pre></div>
<pre><code>##  Indirect Effect in a Mediation Model
##  ====================================
##       method non-centrality  n     power
##        Sobel       1.653684 70 0.3798468
##       Aroian       1.636274 70 0.3732478
##      Goodman       1.671662 70 0.3866988
##        Joint             NA 70 0.4005886
##  Monte Carlo             NA 70 0.3990000
##  ------------------------------------
##  Type 1 error rate: 0.05</code></pre>
<p>Results are very close the the ones obtained with <span
class="modulename">PAMLj</span>.</p>
<p>As a further check for the <code>Monte Carlo</code> method, we can
employ <a href="https://schoemanna.shinyapps.io/mc_power_med/">Monte
Carlo Power Analysis</a>. Unfortunately, <strong>Monte Carlo Power
Analysis</strong> shiny app does not allow to run a simulation without a
<code>seed</code>, so results a bound to the particular
<code>seed</code> one uses. To overcome the issue, we set the number of
simulations to 10000 (patience is required here), so the
<code>seed</code> becomes less important.</p>
<p><img src="rosetta/pics/mediation/input.6.png" width="977" />
<img src="rosetta/pics/mediation/mc.4.png" width="473" /></p>
<p>The results are nicely in line with the ones obtained with <span
class="modulename">PAMLj</span>.</p>
<p>As a final remark, these comparisons demonstrate that one does not
need to simulate a full re-sampling of a bootstrap tests, which is very
time consuming, when parametric Monte Carlo, which is quicker, or joint
significance, which is very fast, yield the same results.</p>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./rosetta.html">PAMLj: rosetta</a>
</div>
</div>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues " target="_blank"> PAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
