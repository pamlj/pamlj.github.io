<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>Factorial designs: power from effect size</title>

        <script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
            $(".toc-details" > a).on("click", function(e) {
                window.scrollBy(0, 100);
            })
                  return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-LLVCE05YX9');
        </script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="ttest.html">t-test</a>
      </li>
      <li>
        <a href="correlation.html">Correlation</a>
      </li>
      <li>
        <a href="prop.html">Proportions</a>
      </li>
      <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="factorial.html">Factorial</a>
      </li>
      <li>
        <a href="mediation.html">Mediation</a>
      </li>
      <li>
        <a href="rosetta.html">Rosetta</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/pamlj/pamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Factorial designs: power from effect size</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Factorial designs: power from effect
size</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#between-subjects-anova"
      id="toc-between-subjects-anova">Between-subjects ANOVA</a>
      <ul>
      <li><a href="#gpower" id="toc-gpower">G*Power</a></li>
      <li><a href="#r" id="toc-r">R</a></li>
      <li><a href="#pamlj" id="toc-pamlj">PAMLj</a></li>
      </ul></li>
      <li><a href="#repeated-measures-anova"
      id="toc-repeated-measures-anova">Repeated Measures ANOVA</a>
      <ul>
      <li><a href="#superpower" id="toc-superpower">Superpower</a></li>
      <li><a href="#gpower-1" id="toc-gpower-1">G*Power</a></li>
      <li><a href="#pamlj-1" id="toc-pamlj-1">PAMLj</a></li>
      <li><a href="#required-n" id="toc-required-n">Required N</a>
      <ul>
      <li><a href="#gpower-2" id="toc-gpower-2">G*Power</a></li>
      <li><a href="#pamlj-2" id="toc-pamlj-2">PAMLj</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#mixed-anova" id="toc-mixed-anova">Mixed
      ANOVA</a></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      <li><a href="#references" id="toc-references">References</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div class="version">
<p>
0.2.0
</p>
</div>
<div style="clear:both">

</div>
<p>Here we compare the results of <span class="modulename">PAMLj</span>
with other software that performs power analysis. In particular, we will
compare our results with <a
href="https://cran.r-project.org/web/packages/pwr/pwr.pdf">R pwr
package</a> and <a
href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower">G*Power</a>.</p>
<div id="between-subjects-anova" class="section level1">
<h1>Between-subjects ANOVA</h1>
<p>When dealing with Between-subjects designs, the
<code>Factorial Design Power Analysis</code> sub-command is equivalent
to the <code>GLM power analysis</code>, so the results perfectly agree.
The only difference between the two sub-commands is that the GLM command
requires to input the model degrees of freedom, whereas the Factorial
sub-command requires to input the total number of groups in the designs.
In <a href="./rosetta_glm_posthoc.html">Rosetta: GLM posthoc power</a>
we have seen that <code>GLM power analysis</code> results align with
G*Power and <code>pwr::pwr.f2.test</code> R function, so here we simply
need to show that <code>Factorial Design Power Analysis</code>
sub-command indeed agrees with <code>GLM power analysis</code>.</p>
<p>We use the ANOVA example in
<a href="./rosetta_glm_posthoc.html">Rosetta: GLM posthoc power</a>, in
which an ANOVA design <span class="math inline">\(A \times B \times
C\)</span> with <span class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span> having 3 levels and <span
class="math inline">\(C\)</span> with 4 levels. Thus the overall model
features 36 groups, with <span class="math inline">\(A\)</span> and
<span class="math inline">\(B\)</span> effects having 3 groups and 2
degrees of freedom, and <span class="math inline">\(C\)</span> having 4
groups and 3 DF. The researcher is interested in the power of the test
associated with the interaction <span
class="math inline">\(A*B\)</span>, with a partial Eta-squared <span
class="math inline">\(p\eta^2=0.05665751\)</span> (here the value is
slightly different than in GPower manual, but this value honors the f
value used in the manual). The interaction spreads across 9 groups or
<span class="math inline">\(DF=2*2=4\)</span> degrees of freedom. Here
are the parameters.</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = Sample Size</li>
<li><span class="math inline">\(p\eta^2\)</span> = 0.05665751</li>
<li><span class="math inline">\(f\)</span> = 0.24507</li>
<li>Effect DF = 4</li>
<li>Number of groups in the design = 36</li>
<li>Model DF = 35</li>
<li>Power = .475627</li>
<li>Alpha = .05</li>
<li>Correct results: N = 108</li>
</ul>
</div>
<div id="gpower" class="section level2">
<h2>G*Power</h2>
<p>First notice that for this problem, GPower offers <em>F test: Fixed
effects ANOVA</em> routine, which requires an <span
class="math inline">\(f\)</span> as the effect size . <span
class="math inline">\(f\)</span> is simply the square root of <span
class="math inline">\(f^2\)</span> so it can be computed from the
partial Eta-squared as <span
class="math inline">\(f=\sqrt{p\eta^2/(1-p\eta^2)}\)</span> .</p>
<p>Plugging in the parameters we obtain:</p>
<p><img src="rosetta/pics/glm/gpower.n.glm.3.png" width="680" /></p>
</div>
<div id="r" class="section level2">
<h2>R</h2>
<p>As we have seen in <a href="./rosetta_glm_posthoc.html">Rosetta: GLM
posthoc power</a>, <code>pwr.f2.test</code> command will underestimate
the power due to the fact that the non centrality parameter is smaller
than the one used in G*Power. Nonetheless, we can get an approximated
estimation of the sample size by computing the N employing the whole
model DF <span class="math inline">\(m=35\)</span>, yielding <span
class="math inline">\(v=N+m+1\)</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fl">0.2450722</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>f2<span class="ot">&lt;-</span>f<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">35</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>power<span class="ot">=</span>.<span class="dv">475627</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>(res<span class="ot">&lt;-</span>pwr<span class="sc">::</span><span class="fu">pwr.f2.test</span>(<span class="at">f2=</span>f2,<span class="at">u=</span><span class="dv">4</span>, <span class="at">power=</span>power,<span class="at">sig.level=</span>.<span class="dv">05</span>))</span></code></pre></div>
<pre><code>## 
##      Multiple regression power calculation 
## 
##               u = 4
##               v = 101.0071
##              f2 = 0.06006038
##       sig.level = 0.05
##           power = 0.475627</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">round</span>(res<span class="sc">$</span>v<span class="sc">+</span>m<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>N</span></code></pre></div>
<pre><code>## [1] 137</code></pre>
<p>As expected, the required sample size obtained in
<code>pwr.f2.test</code> is larger than the one obtained in GPower.</p>
</div>
<div id="pamlj" class="section level2">
<h2>PAMLj</h2>
<p>We plug in the partial Eta-squared and the required parameters, and
we obtain N=108, as in GPower.</p>
<p><img src="rosetta/pics/factorial/facpeta.n.1.png" width="586" />
<img src="rosetta/pics/factorial/facpeta.n.2.png" width="577" /></p>
<p>To obtain a practically equivalent result of the one obtained with
<code>pwr.f2.test</code>, we can simply select the <code>Liberal</code>
in the <code>Non-centrality parameter options</code> option.</p>
<p><img src="rosetta/pics/factorial/facpeta.n.3.png" width="582" />
<img src="rosetta/pics/factorial/facpeta.n.4.png" width="606" /></p>
</div>
</div>
<div id="repeated-measures-anova" class="section level1">
<h1>Repeated Measures ANOVA</h1>
<p>To test the <code>Factorial design power analysis</code> sub-module
for repeated measures or mixed designs, we can compare results with
GPower and
<a href='https://aaroncaldwell.us/SuperpowerBook/' target='_blank'>Superpower
R package</a>. However, in G*Power the default effect size used for
repeated-measures effects is defined in a different way as compared with
<code>Factorial design power analysis</code> sub-module, Superpower or
even SPSS. Moreover, <code>Superpower</code> package requires to input
the expected means of the design cells and it only produces estimation
of power,not the required N. Nonetheless, we can still make some useful
comparison.</p>
<p>We start with a 2x2 repeated measures design as described in
<a href='https://aaroncaldwell.us/SuperpowerBook/repeated-measures-anova.html#part-4' target='_blank'>Caldwell
et al. Superpower 2x2 within-within example</a>. They tested a 2x2
design with 25 participants, with interaction effect as follows:</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = Power</li>
<li>AXB <span class="math inline">\(p\eta^2\)</span> = 0.1428571</li>
<li><span class="math inline">\(f\)</span> = 0.40825</li>
<li>Effect DF = 1</li>
<li>Number of groups in the design = 1</li>
<li>N = 25</li>
<li>Alpha = .05</li>
<li>Correct results: AxB power =.484</li>
</ul>
</div>
<div id="superpower" class="section level2">
<h2>Superpower</h2>
<p>In the <code>Superpower</code> package, we can obtain the results
with the following code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">700</span>, <span class="dv">670</span>, <span class="dv">670</span>, <span class="dv">700</span>) </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>string <span class="ot">=</span> <span class="st">&quot;2w*2w&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                              <span class="at">mu =</span> mu, </span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                              <span class="at">sd =</span> sd, </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                              <span class="at">r =</span> r, <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##        power partial_eta_squared cohen_f non_centrality
## a    5.00000             0.00000 0.00000              0
## b    5.00000             0.00000 0.00000              0
## a:b 48.40183             0.14286 0.40825              4</code></pre>
</div>
<div id="gpower-1" class="section level2">
<h2>G*Power</h2>
<p>As regard <code>G*Power</code>, the correct input requires some
reasoning. First, <code>G*Power</code> uses different definition of the
effect size. Both <code>Superpower</code> and <span
class="modulename">PAMLj</span> use the standard partial-eta squared,
the same effect size one would find in SPSS repeated-measure Anova
analysis. To set <code>G*Power</code> to use this effect size, we
selected the appropriate option in <code>Options</code>.</p>
<p><img src="rosetta/pics/factorial/facpeta.n.5.png" width="602" /></p>
<p>Furtheremore, <code>G*Power</code> requires in input the number of
repeated measures and the number of groups in the design. Because the
example is a completely repeated measure design, the number of groups is
simply 1. However, even though the interaction has 4 repeated measures,
the actual degrees of freedom are only 1, because for the interaction we
have <span class="math inline">\(DF=(a-1)(b-1)\)</span>, where <span
class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span> are the number of levels of the
factors. Now, to “trick” <code>G*Power</code> to compute the power for
an effect with 1 DF, we should declare that the repeated measures levels
are 2. After all, a 2-way interaction in a repeated measure design is
simply the differences between two difference values, so the setup is
not so far away from the actual design. That, indeed, produces the
correct output.</p>
<p><img src="rosetta/pics/factorial/facpeta.n.6.png" width="942" /></p>
</div>
<div id="pamlj-1" class="section level2">
<h2>PAMLj</h2>
<p>The setup in <span class="modulename">PAMLj</span> is straightforward
and produced the expected results.</p>
<p><img src="rosetta/pics/factorial/facpeta.n.7.png" width="588" />
<img src="rosetta/pics/factorial/facpeta.n.8.png" width="545" /></p>
</div>
<div id="required-n" class="section level2">
<h2>Required N</h2>
<p>We can use the same design to test the convergence of G*Power and
<span class="modulename">PAMLj</span> in computing the required N.</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = N</li>
<li>AXB <span class="math inline">\(p\eta^2\)</span> = 0.1428571</li>
<li><span class="math inline">\(f\)</span> = 0.40825</li>
<li>Effect DF = 1</li>
<li>Number of groups in the design = 1</li>
<li>Power = .90</li>
<li>Alpha = .05</li>
<li>Correct results: AxB N =66</li>
</ul>
</div>
<div id="gpower-2" class="section level3">
<h3>G*Power</h3>
<p><img src="rosetta/pics/factorial/facpeta.n.9.png" width="611" /></p>
</div>
<div id="pamlj-2" class="section level3">
<h3>PAMLj</h3>
<p><img src="rosetta/pics/factorial/facpeta.n.11.png" width="591" />
<img src="rosetta/pics/factorial/facpeta.n.12.png" width="542" /></p>
<p>Results are identical with required <span
class="math inline">\(N=66\)</span>. As an additional test, we can ask
<code>Superpower</code> to compute the power fo <span
class="math inline">\(N=66\)</span>, expecting an estimated power very
similar to .90.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">700</span>, <span class="dv">670</span>, <span class="dv">670</span>, <span class="dv">700</span>) </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">66</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>string <span class="ot">=</span> <span class="st">&quot;2w*2w&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>                              <span class="at">mu =</span> mu, </span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>                              <span class="at">sd =</span> sd, </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                              <span class="at">r =</span> r, <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##        power partial_eta_squared cohen_f non_centrality
## a    5.00000             0.00000 0.00000           0.00
## b    5.00000             0.00000 0.00000           0.00
## a:b 89.27484             0.13976 0.40307          10.56</code></pre>
<p>Interestengly, if we user <code>Superpower</code> simulation-based
power estimation, we get an even closer result to the one obtained in
<span class="modulename">PAMLj</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">700</span>, <span class="dv">670</span>, <span class="dv">670</span>, <span class="dv">700</span>) </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">66</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>string <span class="ot">=</span> <span class="st">&quot;2w*2w&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                              <span class="at">mu =</span> mu, </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>                              <span class="at">sd =</span> sd, </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>                              <span class="at">r =</span> r,<span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>random_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>,<span class="at">seed=</span><span class="dv">12</span><span class="sc">^</span><span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">zapsmall</span>(random_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##           power effect_size
## anova_a     4.7     0.01444
## anova_b     5.1     0.01595
## anova_a:b  90.4     0.14863</code></pre>
</div>
</div>
</div>
<div id="mixed-anova" class="section level1">
<h1>Mixed ANOVA</h1>
<p>Let’s now assume that the design we just analyzed was a mixed
between-within design. We can use an example in
<a href='https://aaroncaldwell.us/SuperpowerBook/mixed-anova.html#b4w-design' target='_blank'>Caldwell
et al. Superpower Complex Mixed Anova example</a>. Here we have 4 (Time)
x 2 (Treatment) design, with Time with four repeated measures and
Treatment with two groups. Differently from the example in Caldwell et
al., we assume 60 participants, so the power estimates do not ceil up to
1. The setup is the following:</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = power</li>
<li>Treatment <span class="math inline">\(p\eta^2\)</span> = 0.01598
(df=1)</li>
<li>Time <span class="math inline">\(p\eta^2\)</span> = 0.04717
(df=3)<br />
</li>
<li>Treatment X Time <span class="math inline">\(p\eta^2\)</span> =
0.02418 (df=3)</li>
<li>Number of groups in the design = 2</li>
<li>N = 60 (30 per group)</li>
<li>Alpha = .05</li>
</ul>
</div>
<p>Running the analysis with <code>Superpower</code> we obtain.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>cor_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,.<span class="dv">6</span>,.<span class="dv">491</span>,.<span class="dv">399</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                  .<span class="dv">6</span>,<span class="dv">1</span>,.<span class="dv">495</span>,.<span class="dv">402</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                  .<span class="dv">491</span>,.<span class="dv">495</span>,<span class="dv">1</span>,.<span class="dv">491</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                  .<span class="dv">399</span>,.<span class="dv">402</span>,.<span class="dv">491</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">4</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>cor_2 <span class="ot">&lt;-</span> cor_1<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>pain_cor_mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rbind</span>(cor_1,cor_2),</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>                      <span class="fu">rbind</span>(cor_2,cor_1))</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="st">&quot;2b*4w&quot;</span>,</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">30</span>,</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">2.4</span>, <span class="fl">2.38</span>, <span class="fl">2.05</span>, <span class="fl">1.90</span>,</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>                                     <span class="fl">2.4</span>, <span class="fl">2.39</span>, <span class="fl">2.36</span>, <span class="fl">2.30</span>),</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>                              <span class="at">sd =</span> .<span class="dv">92</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>                              <span class="at">r =</span> pain_cor_mat,</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>                              <span class="at">labelnames =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;sensory&quot;</span>, <span class="st">&quot;standard&quot;</span>,</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>                                             <span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;t1&quot;</span>, <span class="st">&quot;t2&quot;</span>, <span class="st">&quot;t3&quot;</span>, <span class="st">&quot;t4&quot;</span>),</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>                              <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##                   power partial_eta_squared cohen_f non_centrality
## Treatment      15.90956             0.01598 0.12742        0.94169
## TIME           67.91487             0.04717 0.22249        8.61356
## Treatment:TIME 37.65318             0.02418 0.15742        4.31189</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>exact_result<span class="sc">$</span>aov_result</span></code></pre></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: y
##           Effect     df  MSE      F  pes p.value
## 1      Treatment  1, 58 2.06   0.94 .016    .336
## 2           TIME 3, 174 0.44 2.87 * .047    .038
## 3 Treatment:TIME 3, 174 0.44   1.44 .024    .234
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>which align quite well with the <span class="modulename">PAMLj</span>
results, with some small differences mostly due to approximation.</p>
<p><strong>Main effect of Treatment</strong></p>
<p><img src="rosetta/pics/factorial/facpeta.n.13.png" width="1188" /></p>
<p><strong>Main effect of Time</strong></p>
<p><img src="rosetta/pics/factorial/facpeta.n.14.png" width="1166" /></p>
<p><strong>Interaction</strong></p>
<p><img src="rosetta/pics/factorial/facpeta.n.15.png" width="1241" /></p>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./rosetta.html">PAMLj: rosetta</a>
</div>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues " target="_blank"> PAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
