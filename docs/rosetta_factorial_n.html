<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>Factorial designs: Required N</title>

        <script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
            $(".toc-details" > a).on("click", function(e) {
                window.scrollBy(0, 100);
            })
                  return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-LLVCE05YX9');
        </script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="ttest.html">t-test</a>
      </li>
      <li>
        <a href="correlation.html">Correlation</a>
      </li>
      <li>
        <a href="prop.html">Proportions</a>
      </li>
      <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="factorial.html">Factorial</a>
      </li>
      <li>
        <a href="mediation.html">Mediation</a>
      </li>
      <li>
        <a href="sem.html">SEM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed Models</a>
      </li>
      <li>
        <a href="rosetta.html">Rosetta</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/pamlj/pamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Factorial designs: Required N</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Factorial designs: Required N</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#repeated-measures-anova"
      id="toc-repeated-measures-anova">Repeated Measures ANOVA</a>
      <ul>
      <li><a href="#effect-size-indices"
      id="toc-effect-size-indices">Effect size indices</a></li>
      <li><a href="#pamlj" id="toc-pamlj">PAMLj</a></li>
      <li><a href="#gpower" id="toc-gpower">G*Power</a></li>
      </ul></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      <li><a href="#references" id="toc-references">References</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div class="version">
<p>
0.2.0
</p>
</div>
<div style="clear:both">

</div>
<p>Here we compare the results of <span class="modulename">PAMLj</span>
with other software that performs power analysis. In particular, we will
compare our results with <a
href="https://cran.r-project.org/web/packages/pwr/pwr.pdf">R pwr
package</a>, <a
href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower">G*Power</a>,
and <a href="https://webpower.psychstat.org/wiki/">WebPower</a>. We
check the results also using and
<a href='https://aaroncaldwell.us/SuperpowerBook/' target='_blank'>Superpower
R package</a>, which does not compute the required N, but can be used to
confirm the power of the required N found with other software.</p>
<div id="repeated-measures-anova" class="section level1">
<h1>Repeated Measures ANOVA</h1>
<p>To test the <code>Factorial design power analysis</code> sub-module
for repeated measures or mixed designs, we can compare results with
GPower and <a href="https://webpower.psychstat.org/wiki/">WebPower</a>.
However, in G*Power the default effect size used for repeated-measures
effects is defined in a different way as compared with
<code>Factorial design power analysis</code> sub-module, Superpower or
even SPSS. Also <a
href="https://webpower.psychstat.org/wiki/">WebPower</a> has a different
definition of the effect size, so some adjustment are required. We
therefore simulate some data yielding the same effect sizes of the one
we test, and employ <code>Superpower</code> to confirm the results.</p>
<div id="effect-size-indices" class="section level2">
<h2>Effect size indices</h2>
<p>We start with a simple one-way repeated measures design with three
repeated measures: To have some data that would yield the parameters to
test, while being able to control the different computations of the
effect size indices, we employed the following set of means and standard
deviations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">### exptected means</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">700</span>, <span class="dv">670</span>, <span class="dv">670</span>) </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## expected sd</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">98.9</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">### expected average correlations among repeated measures</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.514</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">## number of repeated measures</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># a sample size </span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">78</span></span></code></pre></div>
<p>When these values are passed to Superpower, we obtain the following
results.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>string <span class="ot">=</span> <span class="st">&quot;3w&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                              <span class="at">mu =</span> mu, </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                              <span class="at">sd =</span> sd, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                              <span class="at">r =</span> r, <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##      power partial_eta_squared cohen_f non_centrality
## a 80.08726             0.06009 0.25284        9.84503</code></pre>
<p>Thus, we <span class="math inline">\(N=78\)</span> we obtain a power
of <span class="math inline">\(.80\)</span>. The effect size is <span
class="math inline">\(\eta_p^2=.06\)</span> and the we have a <span
class="math inline">\(f=.25\)</span>. To understand the comparisons
across software, we should notice that Superpower computes the <span
class="math inline">\(\eta_p^2\)</span> and the <span
class="math inline">\(f\)</span> accordingly to <span
class="citation">Cohen (<a href="#ref-cohen1988spa">1988</a>)</span>. In
particular,</p>
<p><span class="math display">\[
\eta_p^2=\frac{SS_{eff}}{SS_{eff}+SS_{res}}
\]</span> where <span class="math inline">\(SS_{eff}\)</span> is the
means sum of squares and <span class="math inline">\(SS_{res}\)</span>
is the sum of squares residuals, and the <span
class="math inline">\(f\)</span> effect size is simply</p>
<p>The <span class="math inline">\(f\)</span> is simply</p>
<p><span class="math display">\[
f=\sqrt{\frac{SS_{eff}}{SS_{res}}}=\sqrt{\frac{\eta_p^2}{1-\eta_p^2}}
\]</span></p>
<p>In our data</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>SS_eff<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">sum</span>((mu<span class="sc">-</span><span class="fu">mean</span>(mu))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>SS_res<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span>sd<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>r)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>eta2p<span class="ot">&lt;-</span>SS_eff<span class="sc">/</span>(SS_eff<span class="sc">+</span>SS_res)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">sqrt</span>(eta2p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>eta2p))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;SS_eff=%g, SS_res=%g, eta2p=%.5f, f=%.5f&quot;</span>,SS_eff,SS_res,eta2p,f)</span></code></pre></div>
<pre><code>## [1] &quot;SS_eff=46800, SS_res=732065, eta2p=0.06009, f=0.25284&quot;</code></pre>
<p>Thus, for the required N we have the following setup</p>
<div class="adm adm-setup">
<p>Setup</p>
<ul>
<li>Aim = N</li>
<li>AXB <span class="math inline">\(p\eta^2\)</span> = 0.06</li>
<li><span class="math inline">\(f\)</span> = 0.25284</li>
<li>Number of measures = 3</li>
<li>Effect DF = 2</li>
<li>Number of groups in the design = 1</li>
<li>Alpha = .05</li>
<li>Required power =.80</li>
<li><strong>Correct answer</strong>: N=78</li>
</ul>
</div>
</div>
<div id="pamlj" class="section level2">
<h2>PAMLj</h2>
<p>The setup in <span class="modulename">PAMLj</span> is straightforward
and produced the expected results. In <code>Factorial Design</code>,
<span class="option">Input Mode: Effect Size</span> we insert the input
parameters</p>
<p><img src="rosetta/pics/factorial/fac_n.1.input.1.png" width="634" />
<img src="rosetta/pics/factorial/fac_n.1.output.1.png" width="685" /></p>
<p>Thus, as expected from the results of Superpower command, the
required N to obtain a power of .80 (or larger) is <span
class="math inline">\(N=78\)</span>.</p>
</div>
<div id="gpower" class="section level2">
<h2>G*Power</h2>
<p>For this power analysis, GPower offers <em>F test: Fixed effects
ANOVA</em> routine, which requires an <span
class="math inline">\(f\)</span> as the effect size which is <span
class="math inline">\(f=\sqrt{p\eta^2/(1-p\eta^2)}\)</span>, as stated
above. However, the way GPower defines <span
class="math inline">\(eta_p^2\)</span> and thus <span
class="math inline">\(f\)</span> for within subject designs is different
than the standard definition. To obtain the standard definition (<span
class="math inline">\(SS_{eff}\)</span> over SS_{res}$) we need to
explicitly select the <code>As in SPSS</code> definition in
<code>Options</code>.</p>
<p><img src="rosetta/pics/factorial/fac_n.1.gpower.1.png" width="592" /></p>
<p>Now, we input the <span class="math inline">\(\eta_p^2=.06\)</span>
in ‘Determine’ option and the other parameters and we obtain exactly the
required <span class="math inline">\(N=78\)</span>.</p>
<p><img src="rosetta/pics/factorial/fac_n.1.gpower.1.png" width="592" /></p>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./rosetta.html">PAMLj: rosetta</a>
</div>
</div>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues " target="_blank"> PAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0">
<div id="ref-cohen1988spa" class="csl-entry">
Cohen, J. 1988. <em><span class="nocase">Statistical Power Analysis for
the Behavioral Sciences</span></em>. Lawrence Erlbaum Associates.
</div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
