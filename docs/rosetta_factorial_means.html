<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Marcello Gallucci" />
    
    
    <title>Factorial designs: power from means and SD</title>

        <script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
            $(".toc-details" > a).on("click", function(e) {
                window.scrollBy(0, 100);
            })
                  return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-LLVCE05YX9');
        </script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="ttest.html">t-test</a>
      </li>
      <li>
        <a href="correlation.html">Correlation</a>
      </li>
      <li>
        <a href="prop.html">Proportions</a>
      </li>
      <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="factorial.html">Factorial</a>
      </li>
      <li>
        <a href="mediation.html">Mediation</a>
      </li>
      <li>
        <a href="sem.html">SEM</a>
      </li>
      <li>
        <a href="rosetta.html">Rosetta</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/pamlj/pamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Factorial designs: power from means and SD</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Factorial designs: power from means and
SD</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#data" id="toc-data">Data</a></li>
      <li><a href="#between-subjects-anova"
      id="toc-between-subjects-anova">Between-subjects ANOVA</a></li>
      <li><a href="#repeated-measures-designs"
      id="toc-repeated-measures-designs">Repeated measures
      designs</a></li>
      <li><a href="#mixed-anova" id="toc-mixed-anova">Mixed ANOVA</a>
      <ul>
      <li><a href="#expected-power" id="toc-expected-power">Expected
      Power</a></li>
      <li><a href="#required-n" id="toc-required-n">Required N</a></li>
      </ul></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Marcello
Gallucci</p>
                      </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div class="version">
<p>
0.2.0
</p>
</div>
<div style="clear:both">

</div>
<p>Here we compare the results of <span class="modulename">PAMLj</span>
with other software that performs power analysis. In particular, we will
compare our results with <a
href="https://cran.r-project.org/web/packages/pwr/pwr.pdf">R pwr
package</a>,
<a href='https://aaroncaldwell.us/SuperpowerBook/' target='_blank'>Superpower
R package</a>, and <a
href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower">G*Power</a>.</p>
<div id="data" class="section level1">
<h1>Data</h1>
<p><code>Factorial designs power analysis</code> from
<code>Expected Means</code> of <span class="modulename">PAMLj</span>
requires a dataset with the expected means and the standard deviations
for the desin cells one is planning. Factors of the design should be
listed as categorical factors, and their means and sd should be listed
in subsequent columns. For instance, a simple design with two groups,
can be prepared like this:</p>
<p><img src="rosetta/pics/factorial/facmeans.1.png" width="398" /></p>
<p>When data are defined, one can use the <span class="option_title">
Factorial designs power analysis </span> from <span class="option_mode">
Expected Means </span> interface in define the design factors, their
means and standard deviations.</p>
<p><img src="rosetta/pics/factorial/facmeans.2.png" width="571" /></p>
<p>As soon as the variables are defined, the effect sizes are computed
together with the power parameters.</p>
<p><img src="rosetta/pics/factorial/facmeans.3.png" width="552" /></p>
<p>As a quick test, we can use <code>G*Power</code> to check the
results, using its interface for inputing the means and the standard
deviations.</p>
<p><img src="rosetta/pics/factorial/facmeans.4.png" width="876" /></p>
<p>Results are the same.</p>
<p>Unfortunately, G*Power does not allow to input means and sd other
than for one-way between-subjects designs, so we cannot test <span
class="modulename">PAMLj</span> for more complex designs. For this
purpose, we can use
<a href='https://aaroncaldwell.us/SuperpowerBook/' target='_blank'>Superpower
R package</a>, which allows computing the expected power starting from
an array of means and standard deviations.</p>
</div>
<div id="between-subjects-anova" class="section level1">
<h1>Between-subjects ANOVA</h1>
<p>We can use the dataset <code>factorial</code> which comes with <span
class="modulename">PAMLj</span> in the <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
data library.</p>
<p><img src="rosetta/pics/factorial/facmeans.5.png" width="743" /></p>
<p>Data describe the means and standard deviations for a 2X3X2
design.</p>
<p><img src="rosetta/pics/factorial/facmeans.data.png" width="565" /></p>
<p>In <code>Factorial designs power analysis</code> from
<code>Expected Means</code> we can simply input the factors, indicating
also the column representing the means and the one representing the
standard devations.</p>
<p><img src="rosetta/pics/factorial/facmeans.6.png" width="579" /></p>
<p>For the purpose of computing the expected power, we can set the
sample size to 240, corresponding to 20 cases per cell.</p>
<p><img src="rosetta/pics/factorial/facmeans.7.png" width="589" /></p>
<p><span class="modulename">PAMLj</span> computes the expected effect
sizes and the expected power for all factors effects and their
interaction.</p>
<p>For comparison, we can use <code>Superpower</code> employing the
following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>ds<span class="ot">&lt;-</span>pamlj<span class="sc">::</span>factorial</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>des_str<span class="ot">&lt;-</span><span class="st">&quot;2b*3b*2b&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>design <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> des_str, </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                              <span class="co">#sample size per group </span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                              <span class="co">#pattern of means</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                              <span class="at">mu =</span>ds<span class="sc">$</span>means,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                              <span class="at">sd =</span> std,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                              <span class="at">plot=</span><span class="cn">FALSE</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                       ) </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>                            <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##          power partial_eta_squared cohen_f non_centrality
## a     22.12255             0.00622 0.07909        1.42604
## b     25.56930             0.01018 0.10142        2.34531
## c     62.62434             0.02251 0.15176        5.25104
## a:b   37.63354             0.01565 0.12610        3.62552
## a:c   25.06133             0.00726 0.08550        1.66667
## b:c   26.89367             0.01078 0.10440        2.48490
## a:b:c 19.44604             0.00738 0.08620        1.69427</code></pre>
<p>It is easy to check that the expected power is almost identical
(apart for rounding) for all effects. It is worth noticing that despite
the expected power is identical for the two software, they produce
different effect size indices. This is due to the way the two software
compute the effect sizes. <code>Superpower</code> builds a dataset of
the input sample size and estimate the effect sizes, whereas <span
class="modulename">PAMLj</span> computes the estimated effect sizes in
the population. Because these effect size indices are upward biased, in
small to moderate sample sizes they tend to be larger than in the
population. Indeed, if we ask <code>Superpower</code> to compute the
effect sizes for a very large sample, the estimated indices converge to
the ones obtained in <span class="modulename">PAMLj</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ds<span class="ot">&lt;-</span>pamlj<span class="sc">::</span>factorial</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">5000</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>des_str<span class="ot">&lt;-</span><span class="st">&quot;2b*3b*2b&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>design <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> des_str, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                              <span class="co">#sample size per group </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                              <span class="co">#pattern of means</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                              <span class="at">mu =</span>ds<span class="sc">$</span>means,</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                              <span class="at">sd =</span> std,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>                              <span class="at">plot=</span><span class="cn">FALSE</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                       ) </span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design,</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>                            <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##       power partial_eta_squared cohen_f non_centrality
## a       100              0.0059  0.0771       356.5104
## b       100              0.0097  0.0989       586.3281
## c       100              0.0214  0.1479      1312.7604
## a:b     100              0.0149  0.1229       906.3802
## a:c     100              0.0069  0.0833       416.6667
## b:c     100              0.0102  0.1018       621.2240
## a:b:c   100              0.0070  0.0840       423.5677</code></pre>
</div>
<div id="repeated-measures-designs" class="section level1">
<h1>Repeated measures designs</h1>
<p>Let’s now assume that the design we have analyzed before was a
repeated measures design. In repeated measures designs, to compute the
power parameters from means and standard deviations, one needs to
anticipate the average correlations among repeated measures. Let’s
assume that the repeated measures correlate, on average, .2. We can
setup the analysis as before, but in the <span class="option">Repeated
Measures</span> tab, we can declare which factor is within-subjects and
input the expected correlation. In this example, we set the sample size
to 50.</p>
<p><img src="rosetta/pics/factorial/facmeans.8.png" width="563" /></p>
<p>Having set the factors as repeated measures factors and with a
non-zero correlation changes the effect size estimation and the
estimated power.</p>
<p><img src="rosetta/pics/factorial/facmeans.9.png" width="548" /></p>
<p>We should also note that the residuals degrees of freedom are now
different, because they depend on the sample size and degrees of freedom
of the effect.</p>
<p>For comparison, we run the same analysis with
<code>Superpower</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>ds<span class="ot">&lt;-</span>pamlj<span class="sc">::</span>factorial</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>des_str<span class="ot">&lt;-</span><span class="st">&quot;2w*3w*2w&quot;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>r<span class="ot">&lt;-</span>.<span class="dv">2</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>design <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> des_str, </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                              <span class="co">#sample size per group </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                              <span class="co">#pattern of means</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                              <span class="at">mu =</span>ds<span class="sc">$</span>means,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                              <span class="at">r=</span>r,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>                              <span class="at">sd =</span> std,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                              <span class="at">plot=</span><span class="cn">FALSE</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                       ) </span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>                            <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##          power partial_eta_squared cohen_f non_centrality
## a     54.36549             0.08336 0.30157        4.45638
## b     66.25727             0.06958 0.27347        7.32910
## c     97.78008             0.25087 0.57869       16.40951
## a:b   85.21552             0.10363 0.34001       11.32975
## a:c   60.92486             0.09608 0.32603        5.20833
## b:c   68.95522             0.07342 0.28149        7.76530
## a:b:c 51.50017             0.05126 0.23244        5.29460</code></pre>
<p>We can see that the results are pretty similar. The difference is due
to the fact that <code>Superpower</code> estimates power based on the
sample estimates of the effect size, whereas <span
class="modulename">PAMLj</span> uses the population effect size. To add
an additional proof, we can ask GPower to compute the power for a
Repeated measure effect with effect size <span
class="math inline">\(p\eta^2=.0818\)</span>, 1 DF (two measures), all
within effects (1 group) with <span class="math inline">\(N=50\)</span>
(and SPSS effect size,
cf. <a href="./rosetta_factorial_peta.html">Rosetta: Factorial power
from effect size</a>).</p>
<p><img src="rosetta/pics/factorial/facmeans.10.png" width="937" /></p>
<p>Results are indeed identical to <span class="modulename">PAMLj</span>
results.</p>
</div>
<div id="mixed-anova" class="section level1">
<h1>Mixed ANOVA</h1>
<div id="expected-power" class="section level2">
<h2>Expected Power</h2>
<p>We can now test the module with a mixed design, with one repeated
measure factor (say A) and the other two (B and C) as between-subjects
factors. This yields a design with 6 groups, so we can set the sample
size to 120, corresponding to 20 cases per group. As for the
correlations among repeated measures, we can set it to .5. In PAMLj, we
simply set up the input as follows.</p>
<p><img src="rosetta/pics/factorial/facmeans.11.png" width="584" /></p>
<p>and for the repeated measures we have</p>
<p><img src="rosetta/pics/factorial/facmeans.12.png" width="567" /></p>
<p>Results are the following:</p>
<p><img src="rosetta/pics/factorial/facmeans.13.png" width="549" /></p>
<p>For comparison, we run the same analysis with
<code>Superpower</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>ds<span class="ot">&lt;-</span>pamlj<span class="sc">::</span>factorial</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>des_str<span class="ot">&lt;-</span><span class="st">&quot;2w*3b*2b&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>r<span class="ot">&lt;-</span>.<span class="dv">5</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>design <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> des_str, </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                              <span class="co">#sample size per group </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                              <span class="at">n =</span> n, </span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>                              <span class="co">#pattern of means</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>                              <span class="at">mu =</span>ds<span class="sc">$</span>means,</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                              <span class="at">r=</span>r,</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>                              <span class="at">sd =</span> std,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>                              <span class="at">plot=</span><span class="cn">FALSE</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>                       ) </span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_exact</span>(design,</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>                            <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="fu">zapsmall</span>(exact_result<span class="sc">$</span>main_results)</span></code></pre></div>
<pre><code>##          power partial_eta_squared cohen_f non_centrality
## b     40.34061             0.01312 0.11531        3.90885
## c     83.85936             0.02891 0.17253        8.75174
## b:c   42.45058             0.01389 0.11869        4.14149
## a     75.85217             0.02368 0.15573        7.13021
## b:a   97.40707             0.05808 0.24831       18.12760
## c:a   82.05198             0.02756 0.16836        8.33333
## b:c:a 73.90719             0.02801 0.16975        8.47135</code></pre>
<p>All considering, results are enough similar.</p>
</div>
<div id="required-n" class="section level2">
<h2>Required N</h2>
<p>To validate PAMLj computation of the required sample size, we can use
GPOWER. Using the <code>factorial</code> dataset, assuming one repeated
measure factor (A) with correlation equal to .5, the other two (B and C)
as between-subjects factors, with required power set to .90, we obtain
the following results.</p>
<p><img src="rosetta/pics/factorial/facmeans.14.png" width="529" /></p>
<p>We can now pick the interaction <span
class="math inline">\(A*B\)</span>, with <span
class="math inline">\(p\eta^2=.0293\)</span> with 2 degrees of freedom.
In GPower, we can use
<code>ANOVA: Repeated measures, within-between interactions</code>, with
<code>Options</code> set to <code>SPSS</code>. To approximate the
results, we can set the <code>Number of repeated measures</code> to 2,
and the <code>Number of groups</code> to 3 (factor B has three
levels).</p>
<p><img src="rosetta/pics/factorial/facmeans.15.png" width="943" /></p>
<p>The results are similar but not very close, being the <span
class="math inline">\(N=219\)</span> for PAMLj and <span
class="math inline">\(N=216\)</span> for GPower. However, in this case
it is not a matter of approximation or rounding. Notice that both
software indicates the same effect size and the same degrees of freedom,
PAMLj gives a slightly larger required N because PAMLj takes into the
account that the whole model has three factors, whereas this information
cannot be passed to GPower. In fact, PAMLj yields the same results of
GPower if one selects the option <code>Liberal</code> in the
<code>Non-centrality parameter</code>. The option <code>Liberal</code>,
in fact, estimates the required N without considering the whole model
degrees of freedom, but only the effect degrees of freedom (cf
<a href="./details_failure.html">Extreme values warnings</a>
<a href="./specs_fncp.html">F-Test Non-centrality parameters</a>).</p>
<p><img src="rosetta/pics/factorial/facmeans.16.png" width="573" />
<img src="rosetta/pics/factorial/facmeans.17.png" width="560" /></p>
</div>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues " target="_blank"> PAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./rosetta.html">PAMLj: rosetta</a>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
