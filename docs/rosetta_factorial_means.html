<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Factorial designs: power from means and SD</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LLVCE05YX9');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PAMLj</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="correlation.html">Correlation</a>
</li>
<li>
  <a href="glm.html">GLM</a>
</li>
<li>
  <a href="rosetta.html">Rosetta</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pamlj/pamlj">View on Github</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Factorial designs: power from means and
SD</h1>

</div>


<div id="power-analysis-for-the-factorial-designs"
class="section level1">
<h1>Power Analysis for the Factorial Designs</h1>
<p><span class="version"> <span class="versiontitle"> PAMLj version ≥
</span> 0.2.0 </span></p>
<p>Here we compare the results of <span class="modulename">PAMLj</span>
with other software that performs power analysis. In particular, we will
compare our results with <a
href="https://cran.r-project.org/web/packages/pwr/pwr.pdf">R pwr
package</a>,
<a href='https://aaroncaldwell.us/SuperpowerBook/' target='_blank'>Superpower
R package</a>, and <a
href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower">G*Power</a>.</p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p><code>Factorial designs power analysis</code> from
<code>Expected Means</code> of <span class="modulename">PAMLj</span>
requires a dataset with the expected means and the standard deviations
for the desin cells one is planning. Factors of the design should be
listed as categorical factors, and their means and sd should be listed
in subsequent columns. For instance, a simple design with two groups,
can be prepared like this:</p>
<p><img src="rosetta/pics/factorial/facmeans.1.png" width="398" /></p>
<p>When data are defined, one can use the
<code>Factorial designs power analysis</code> from
<code>Expected Means</code> interface in define the design factors,
their means and standard deviations.</p>
<p><img src="rosetta/pics/factorial/facmeans.2.png" width="571" /></p>
<p>As soon as the variables are defined, the effect sizes are computed
together with the power parameters.</p>
<p><img src="rosetta/pics/factorial/facmeans.3.png" width="552" /></p>
<p>As a quick test, we can use <code>G*Power</code> to check the
results, using its interface for inputing the means and the standard
deviations.</p>
<p><img src="rosetta/pics/factorial/facmeans.4.png" width="876" /></p>
<p>Results are almost the same, with only one unit of difference.</p>
<p>Unfortunately, G*Power does not allow to input means and sd other
than for one-way between-subjects designs, so we cannot test <span
class="modulename">PAMLj</span> for more complex designs. For this
purpose, we can use
<a href='https://aaroncaldwell.us/SuperpowerBook/' target='_blank'>Superpower
R package</a>, which allows computing the expected power starting from
an array of means and standard deviations.</p>
</div>
<div id="between-subjects-anova" class="section level1">
<h1>Between-subjects ANOVA</h1>
<p>We can use the dataset <code>factorial</code> which comes with <span
class="modulename">PAMLj</span> in the <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
data library.</p>
<p><img src="rosetta/pics/factorial/facmeans.5.png" width="743" /></p>
<p>Data describe the means and standard deviations for a 2X3X2
design.</p>
<p><img src="rosetta/pics/factorial/facmeans.data.png" width="565" /></p>
<p>In <code>Factorial designs power analysis</code> from
<code>Expected Means</code> we can simply input the factors, indicating
also the column representing the means and the one representing the
standard devations.</p>
<p><img src="rosetta/pics/factorial/facmeans.6.png" width="579" /></p>
<p>For the purpose of computing the expected power, we can set the
sample size to 240, corresponding to 20 cases per cell.</p>
<p><img src="rosetta/pics/factorial/facmeans.7.png" width="589" /></p>
<p><span class="modulename">PAMLj</span> computes the expected effect
sizes and the expected power for all factors effects and their
interaction.</p>
<p>For comparison, we can use <code>Superpower</code> employing the
following code:</p>
<pre class="r"><code>ds&lt;-pamlj::factorial
std&lt;-8
n&lt;-20
des_str&lt;-&quot;2b*3b*2b&quot;
design &lt;- Superpower::ANOVA_design(design = des_str, 
                              #sample size per group 
                              n = n, 
                              #pattern of means
                              mu =ds$means,
                              sd = std,
                              plot=FALSE
                       ) 
exact_result &lt;- Superpower::ANOVA_exact(design,
                            alpha_level = .05,
                            verbose = FALSE)
zapsmall(exact_result$main_results)</code></pre>
<pre><code>##          power partial_eta_squared cohen_f non_centrality
## a     22.12255             0.00622 0.07909        1.42604
## b     25.56930             0.01018 0.10142        2.34531
## c     62.62434             0.02251 0.15176        5.25104
## a:b   37.63354             0.01565 0.12610        3.62552
## a:c   25.06133             0.00726 0.08550        1.66667
## b:c   26.89367             0.01078 0.10440        2.48490
## a:b:c 19.44604             0.00738 0.08620        1.69427</code></pre>
<p>It is easy to check that the expected power is almost identical
(apart for rounding) for all effects. It is worth noticing that despite
the expected power is identical for the two software, they produce
different effect size indices. This is due to the way the two software
compute the effect sizes. <code>Superpower</code> build a dataset of the
input sample size and estimate the effect size, whereas <span
class="modulename">PAMLj</span> computes the estimated effect size in
the population. Because these effect size are upward biased, in small to
moderate sample size they tend to be larger than in the population.
Indeed, if we ask <code>Superpower</code> to compute the effect sizes
for a very large sample, the estimated indices converge to the ones
obtained in <span class="modulename">PAMLj</span>.</p>
<pre class="r"><code>ds&lt;-pamlj::factorial
std&lt;-8
n&lt;-5000
des_str&lt;-&quot;2b*3b*2b&quot;
design &lt;- Superpower::ANOVA_design(design = des_str, 
                              #sample size per group 
                              n = n, 
                              #pattern of means
                              mu =ds$means,
                              sd = std,
                              plot=FALSE
                       ) 
exact_result &lt;- Superpower::ANOVA_exact(design,
                            alpha_level = .05,
                            verbose = FALSE)
zapsmall(exact_result$main_results)</code></pre>
<pre><code>##       power partial_eta_squared cohen_f non_centrality
## a       100              0.0059  0.0771       356.5104
## b       100              0.0097  0.0989       586.3281
## c       100              0.0214  0.1479      1312.7604
## a:b     100              0.0149  0.1229       906.3802
## a:c     100              0.0069  0.0833       416.6667
## b:c     100              0.0102  0.1018       621.2240
## a:b:c   100              0.0070  0.0840       423.5677</code></pre>
</div>
<div id="repeated-measures-designs" class="section level1">
<h1>Repeated measures designs</h1>
<p>Let’s now assume that the design we have analyzed before was a
repeated measures design. In repeated measures designs, to compute the
power parameters from means and standard deviations, one needs to
anticipate the average correlations among repeated measures. Let’s
assume that the repeated measures correlate, on average, .2. We can
setup the analysis as before, but in the <code>Repeated Measures</code>
tab, we can declare which factor is within-subjects and input the
expected correlation. In this example, we set the sample size to 50.</p>
<p><img src="rosetta/pics/factorial/facmeans.8.png" width="564" /></p>
<p>Having set the factors as repeated measures factors and with a
non-zero correlation changes the effect size estimation and the
estimated power.</p>
<p><img src="rosetta/pics/factorial/facmeans.9.png" width="548" /></p>
<p>We should also note that the residuals degrees of freedom are now
different, and they depended on the sample size and degrees of freedom
of the effect.</p>
<p>For comparison, we run the same analysis with
<code>Superpower</code>.</p>
<pre class="r"><code>ds&lt;-pamlj::factorial
std&lt;-8
n&lt;-50
des_str&lt;-&quot;2w*3w*2w&quot;
r&lt;-.2
design &lt;- Superpower::ANOVA_design(design = des_str, 
                              #sample size per group 
                              n = n, 
                              #pattern of means
                              mu =ds$means,
                              r=r,
                              sd = std,
                              plot=FALSE
                       ) 
exact_result &lt;- Superpower::ANOVA_exact(design,
                            alpha_level = .05,
                            verbose = FALSE)
zapsmall(exact_result$main_results)</code></pre>
<pre><code>##          power partial_eta_squared cohen_f non_centrality
## a     54.36549             0.08336 0.30157        4.45638
## b     66.25727             0.06958 0.27347        7.32910
## c     97.78008             0.25087 0.57869       16.40951
## a:b   85.21552             0.10363 0.34001       11.32975
## a:c   60.92486             0.09608 0.32603        5.20833
## b:c   68.95522             0.07342 0.28149        7.76530
## a:b:c 51.50017             0.05126 0.23244        5.29460</code></pre>
<p>We can see that the results are pretty similar. The difference is due
to the fact that <code>Superpower</code> estimates power based on the
sample estimates of the effect size, whereas <span
class="modulename">PAMLj</span> uses the population effect size. To add
an additional proof, we can ask GPower to compute the power for a
Repeated measure effect with effect size <span
class="math inline">\(p\eta^2=.0818\)</span>, 1 DF (two measures), all
within effects (1 group) with <span class="math inline">\(N=50\)</span>
(and SPSS effect size,
cf. <a href="rosetta_factorial_peta.html">Rosetta: Factorial power from
effect size</a>).</p>
<p><img src="rosetta/pics/factorial/facmeans.10.png" width="937" /></p>
<p>Results are indeed identical to <span class="modulename">PAMLj</span>
results.</p>
<h1>
Comments?
</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues "> PAMLj at github</a>
or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
<div id="back-to-pamlj-rosetta" class="section level1">
<h1>Back to <a href="rosetta.html">PAMLj: rosetta</a></h1>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>’</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
