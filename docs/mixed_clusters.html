<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="(Marcello Gallucci)" />
    
    
    <title>Mixed models: handling clusters</title>

        <script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
            $(".toc-details" > a).on("click", function(e) {
                window.scrollBy(0, 100);
            })
                  return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LLVCE05YX9"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-LLVCE05YX9');
        </script>
    
    
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="ttest.html">t-test</a>
      </li>
      <li>
        <a href="correlation.html">Correlation</a>
      </li>
      <li>
        <a href="prop.html">Proportions</a>
      </li>
      <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="factorial.html">Factorial</a>
      </li>
      <li>
        <a href="mediation.html">Mediation</a>
      </li>
      <li>
        <a href="sem.html">SEM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed Models</a>
      </li>
      <li>
        <a href="rosetta.html">Rosetta</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/pamlj/pamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Mixed models: handling clusters</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Mixed models: handling clusters</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#one-clustering-variable"
      id="toc-one-clustering-variable">One clustering variable</a>
      <ul>
      <li><a href="#one-way-repeated-measures-anova-design"
      id="toc-one-way-repeated-measures-anova-design">One-way
      repeated-measures ANOVA design</a></li>
      </ul></li>
      <li><a href="#multi-cluster-designs"
      id="toc-multi-cluster-designs">Multi-cluster designs</a>
      <ul>
      <li><a href="#cross-classified-clusters"
      id="toc-cross-classified-clusters">Cross-classified
      clusters</a></li>
      <li><a href="#nested-cluster-classification"
      id="toc-nested-cluster-classification">Nested cluster
      classification</a></li>
      <li><a href="#apparently-nested-desings"
      id="toc-apparently-nested-desings">Apparently nested
      desings</a></li>
      <li><a href="#apparently-fully-nested-desings"
      id="toc-apparently-fully-nested-desings">Apparently fully nested
      desings</a></li>
      </ul></li>
      <li><a href="#additional-material"
      id="toc-additional-material">Additional material</a></li>
      <li><a href="#examples" id="toc-examples">Examples</a></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> (Marcello
Gallucci)</p>
                      </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<p><span class="keywords"> <span class="keytitle"> keywords </span>
power analysis, mixed models, multiple clusters, participant by stimuli
</span></p>
<div class="version">
<p>
0.8.2
</p>
</div>
<div style="clear:both">

</div>
<p>Here we discuss some rules for handling clustering variables
(grouping variables) in different designs. We focus on building the
clustering variables in the correct way and checking the results sample
structure, so we set <em>expected power</em> as the aim of the analysis,
and we fill all cluster variables required sizes (<span class="option">#
Cluster Levels</span> and <span class="option">N per cluster</span>).
When the the aim of the analysis is N (with <span
class="option">Find</span> being <code>Number of cluster levels</code>
or <code>Cases within clusters</code>), the rules are the same, but one
of size parameter is left empty. It is also a good idea while
experimenting with different designs to set <span
class="option">Algorithm</span> to <span class="option">Raw
approximation</span> which is very fast and does not require us to wait
for a simulation to check the resulting sample structure.</p>
<div id="one-clustering-variable" class="section level1">
<h1>One clustering variable</h1>
<p>Simple designs with one clustering variable are defined by specifying
in <span class="option">Model Syntax</span> the “bars” component of the
formula, such as:</p>
<pre><code>y~1*1+1*x+(1*1|cluster)</code></pre>
<div class="adm adm-note">
<p>Note</p>
<p>Hereinafter the coefficients are immaterial for our discussion, so we
always set them to 1 and assume random intercepts only. The sample
structure is not altered by the coefficient values or the definition of
fixed and random effects. We also fill in all the cluster size fields:
<code># Cluster Levels (k)</code> and <code>N per cluster (n)</code>. It
is clear that, depending on the aim of the analysis, one of these
parameters will be determined by the algorithm.</p>
</div>
<p><span class="modulename">PAMLj</span> reads <code>cluster</code> as
the name of the clustering variable and displays the fields to be filled
in to generate the correct sample based on the cluster variable
definition.</p>
<p><img src="details/mixed/clusters/e1.input.1.png" width="697" /></p>
<p>Now, depending on the aim of the analysis, one needs to fill one of
the fields (<code># Cluster Levels (k)</code> or
<code>N per cluster (n)</code>). Here we discuss the meaning of these
fields, knowing that depending on the goal of the analysis, one of them
will be the target of the power function.</p>
<p>With one clustering variable, <code># Cluster levels (k)</code> is
the number of groups clustering the observations. In a multilevel
design, say with pupils clustered within classes,
<code># Cluster levels (k)</code> is the number of classes in the sample
(or the number to be established by the power analysis). In a
repeated-measures design with conditions repeated within participants,
<code># Cluster levels (k)</code> is the number of participants.</p>
<p><code>N per cluster (n)</code> is the number of observations within
each cluster level (group). In a multilevel design with pupils clustered
within classes, <code>N per cluster (n)</code> is the (average) number
of pupils in the sample (or the number to be established by the power
analysis). In a repeated-measures design with a condition repeated
within participants, <code>N per cluster</code> is the number of
measurements taken for each participant.</p>
<div id="one-way-repeated-measures-anova-design" class="section level3">
<h3>One-way repeated-measures ANOVA design</h3>
<p>Assume we have a repeated-measures design with four time points (see
an example in <a href="./rosetta_mixed1.html">Mixed vs RM-ANOVA</a>),
and one measurement per participant (identified by the variable
<em>ID</em>) at each time point. To define this design, we would
input:</p>
<pre><code>y~1*1+[1,1,1]*time+(1*1|ID)</code></pre>
<p>Then we specify that <code>time</code> is a categorical variable with
4 levels.</p>
<p><img src="details/mixed/clusters/e2.input.1.png" width="554" /></p>
<p>and we set the cluster <code>N per cluster</code> to 4, indicating
that one participant (the cluster unit) has 4 observations (we assume
here we have 10 participants (<span
class="math inline">\(k=10\)</span>), but if the aim is N we would leave
<span class="math inline">\(k\)</span> empty).</p>
<p><img src="details/mixed/clusters/e2.input.2.png" width="679" /></p>
<p>The resulting data look like this:</p>
<pre><code>             y time      ID
1   0.64342217    1       1
2   0.15874249    2       1
3  -0.70961322    3       1
4  -1.46269242    4       1
5  -0.80773575    1       2
6   0.38518147    2       2
7  -1.95162686    3       2
8   2.98249154    4       2
9  -0.04821753    1       3
10 -1.61386528    2       3
11 -0.68877198    3       3
12  1.33885528    4       3</code></pre>
<p>We can see that time is repeated within ID, with one measurement for
each level of time. Table <code>Variable parameters (one sample)</code>
also shows that we are simulating the correct design, because
<em>time</em> has 4 levels (column <em>Value</em>) repeated within
cluster <code>ID</code>.</p>
<p><img src="details/mixed/clusters/e2.output.1.png" width="472" /></p>
<p>In terms of clusters structure, table <code>Cluster parameters</code>
shows that <em>ID</em> has 10 levels, with 4 observations with each
cluster, and 4 observations within, yielding 40 observations in total.
Whereas in this case the <code>N per cluster (n)</code> and
<code>N within</code> may seem redundant, there are many design
structures in which the two columns conveys different information.</p>
<div class="adm adm-note">
<p>Note</p>
<p>To see the tables reporting on sample charateristics, select the
option <span class="option">Variables structure</span> in <span
class="panel"> <i class="fa fa-chevron-down"></i> | Options</span>
panel. <span class="option">Clusters structure</span> produces a table
with information about the variables and their levels. To see an example
of the data generated by your model in <span
class="modulename">PAMLj</span>, select <span class="option">Data
structure</span>.</p>
</div>
<p>Assume now we have a similar design, but within each time condition
the participant is measured 5 times (5 trials). We still have the same
model:</p>
<pre><code>y~1*1+1*time+(1*1|ID)</code></pre>
<p>and the same variable definition (time with 4 levels), but now
<code>N per cluster</code> is 20, which is 4 levels of time × 5
trials.</p>
<p><img src="details/mixed/clusters/e2.input.3.png" width="698" /></p>
<p>The resulting data look like this (first participant):</p>
<pre><code>              y time      ID
1    0.38563267    1       1
2    1.24833377    1       1
3   -0.76549380    1       1
4   -0.94633446    1       1
5    0.72747486    1       1
6   -0.58658441    2       1
7   -1.01631241    2       1
8   -2.66731584    2       1
9    0.62401507    2       1
10   0.15654240    2       1
11  -0.26135861    3       1
12   0.11923442    3       1
13   0.66327673    3       1
14  -0.63811091    3       1
15   0.31462810    3       1
16   0.27796168    4       1
17   0.32836307    4       1
18  -0.34867872    4       1
19  -0.20470434    4       1
20  -0.71480958    4       1</code></pre>
<p>The variable structure is the same as the example above (4 repeated
measures), just observations with each participant are now 20 and thus
the total number of observation is 200.</p>
<div class="adm adm-note">
<p>Note</p>
<p>Notice that categorical variables are built to vary within clusters
by default. This behavior is chosen because in power analysis for mixed
model within-cluster variables are more common. However, <span
class="modulename">PAMLj</span> allows to specify between-clusters
categorical variables (and also continuous variables). Please read
<a href="./mixed_designs.html">Mixed models: Building factorial
designs</a> for help on that.</p>
</div>
</div>
</div>
<div id="multi-cluster-designs" class="section level1">
<h1>Multi-cluster designs</h1>
<p>Here we discuss cases with more than one clustering variable. When
more than one cluster variable is involved, things gets a bit complex (I
dare I say wild), but still those designs are doable in <span
class="modulename">PAMLj</span>. One needs a bit more patience to get it
right.</p>
<p>Two cases are most relevant for researchers: <strong>cross-classified
clustering</strong> and <strong>nested clustering</strong>.</p>
<div id="cross-classified-clusters" class="section level3">
<h3>Cross-classified clusters</h3>
<p>A typical example of cross-classified clustering is an experimental
design in which <span class="math inline">\(P\)</span> participants
(identified by the variable <em>PID</em>) are tested with <span
class="math inline">\(S\)</span> stimuli (variable <em>SID</em>). Every
participant is exposed to each stimulus, and each stimulus is seen by
all participants. We start with the simpler example in which there is
only one measurement for each combination of participant and stimulus (a
participant sees a stimulus only once).</p>
<p>The mixed model is:</p>
<pre><code>y~1*1+1*x+(1*1|PID)+(1*1|SID)</code></pre>
<p>Let’s say we want a sample of 10 participants and 6 stimuli. In total
we have 60 observations, in which each participant has
<code>N per cluster (n)</code> equal to 1, and each stimulus has
<code>N per cluster (n)</code> equal to 1 as well. It may seem counter
intuitive, but the participant is actually repeated only once, but their
measurement is spread across 6 stimuli. Thus, we need to set:</p>
<p><img src="details/mixed/clusters/e3.input.1.png" width="694" /></p>
<p>The resulting data (first participant) will look like this:</p>
<pre><code>        y       PID SID
1   0.741008569   1   1
2  -1.001295926   1   2
3   0.728456584   1   3
4   0.649785351   1   4
5  -1.373459856   1   5
6  -2.073459856   1   6</code></pre>
<p>In the <code>Clusters parameters</code> table we can see that we have
6 observations with each participant (<em>PID</em>), because each
participant sees 6 stimuli, and 10 observations within each stimulus,
because each stimulus is seen by 10 participants.</p>
<p><img src="details/mixed/clusters/e3.output.1.png" width="462" /></p>
<p>Notice, however, that the independent variable <em>x</em> is
continuous, and it is left to vary both across and with clusters by
default. For dealing with multiple clusters variables with between vs
within independent variables, please see
<a href="./mixed_designs.html">Mixed models: Building factorial
designs</a>.</p>
</div>
<div id="nested-cluster-classification" class="section level3">
<h3>Nested cluster classification</h3>
<div class="adm adm-note">
<p>Note</p>
<p>In mixed models estimated following the R package
<strong>lme4</strong> syntax, the expression
<code>(1 | school/class)</code> is just a shorthand for specifying
nested random effects. The operator <code>school/class</code> expands
internally into two terms: one random intercept for the grouping factor
<code>school</code>, and one random intercept for the interaction (i.e.,
nesting) <code>school:class</code>. Formally, the random structure
is:</p>
<pre><code>(1 | school) + (1 | school:class)</code></pre>
<p>This means that we estimate one random intercept (or whatever random
coefficient we include) per school, and one random intercept per class,
and class are uniquely identified by che combination of school and
class. Accordingly, the <code>Effect size indices</code> table indicates
that the cluster variables are <code>school</code> and
<code>school:class</code>.</p>
<p>The <strong>general rule</strong> is that, in mixed models, “nesting”
is not a separate statistical concept—it is only a syntactic shortcut.
What matters is the definition of the grouping factors, which in this
example are <code>school</code> and <code>school:class</code>. Random
coefficients (whatever they are) are computed across the groups defined
by these two variables.</p>
</div>
<p>Here things get ugly: Let us consider one of the classic multilevel
design: pupils within classes within schools. In this design we have two
clustering variables: <em>class</em> and <em>school</em>. In multilevel
terminology, pupils are level 0, classes are level 1 with pupils nested
within classes, and schools are level 2 with classes nested within
schools. To be practical, let us assume we want a sample with 10
schools, each with 6 classes, and each class (on average) with 12
pupils.</p>
<p>First, we set the model:</p>
<pre><code>y~1*1+1*x+(1*1|school/class)</code></pre>
<p>Then we specify that we have 10 schools, each with 6 classes, and
each class has 12 observations (pupils).</p>
<p><img src="details/mixed/clusters/e4.input.1.png" width="680" /></p>
<p>The generated data look similar to the cross-classified data:</p>
<pre><code>row   y             x           school  class
1    0.456717064 -1.017673137      1     1
2   -1.495551991  0.694440645      1     1
3   -0.480543438  0.194002872      1     1
4    0.293003240 -0.116523555      1     1
5   -1.702547420 -1.203825265      1     1
6    1.014035495  0.461345298      1     1
7   -0.415440850 -0.585482460      1     1
8   -1.524924282  0.544323536      1     1
9   -0.106578314 -0.196693360      1     1
10  -0.035543818 -2.741920747      1     1
11   0.229491601  0.170131727      1     1
12  -1.909614050 -1.159812029      1     1
13   1.190966855 -0.356247480      1     2
14  -2.028748115  0.489991721      1     2
15  -1.079830560  1.315918615      1     2
16   0.099924682 -0.330729467      1     2
17  -0.075449795 -2.424778270      1     2
....</code></pre>
<p>However, the estimated model is different as compared with the
cross-classified design. If one looks at the
<code>Clusters parameters</code> table, one finds that the clusters are
now <code>school</code> and <code>school:class</code>, which is exactly
how the model specification expands.</p>
<p><img src="details/mixed/clusters/e4.output.1.png" width="439" /></p>
<p>In terms of cluster size, we obtain the results we intended. Let’s
check if the setup is correct: each school has 6 classes with 12 pupils,
so within each school there are 72 observations. Within each class
nested in school there are 12 pupils. But how many observations we’ll
have in the sample? Well, 720, because we have 72 observations per
school and we have 10 school (<span class="math inline">\(72 \cdot
10=720\)</span>), or , equivalently, 60 classes with 12 pupils (<span
class="math inline">\(60 \cdot 12=720\)</span>). So, the data are
ok.</p>
</div>
<div id="apparently-nested-desings" class="section level3">
<h3>Apparently nested desings</h3>
<p>(Here things remain ugly, but computation gets very slow)</p>
<p>A good rule of thumb in mixed models is that <em>when you are in
doubt about how the clustering variables are related, they are probably
not nested</em>. The second rule is that if nesting (i.e
<code>|cluster1/cluster2</code>) does not come intuitively, and things
are clearer if one explicitly thinks in terms of combinations of
clusters levels. The third rule of thumbs is: clusters defined in
different blocks (<code>(1|cluster)</code> being a block) are
cross-classified.</p>
<p>Consider the following design. We have 10 labs (<em>LAB</em>) (or any
number you like), each lab conducts an experiment with with 20
participants (<em>PID</em>), each responding to 15 stimuli
(<em>SID</em>). Thus, apparently we have a cross-classified experiment
nested within labs. What this design actually means is that each level
of <em>labs</em> has all 20 X 15 observations corresponding to the
cross-classified clustering we have seen above. Thus, we do not have
nesting at all, but simply a 3-way classification. Assume the experiment
involves a dichotomous factor (<em>cond</em>) with two levels, repeated
within-participants. That is, each participant respond to the 15 stimuli
in two different conditions.</p>
<p>Now we have to think carefully: we have 10 unique labs, so each labs
requires a random intercept: <code>(1|LAB)</code>. Than we have 20
participants for each lab, and each participant is uniquely identified
by being in a particular lab (participant 1 in lab 1 is different than
participant 1 in lab 2): <code>(1|LAB:PID)</code>. Stimuli, however, are
not different across labs, because each lab uses the same stimuli. Thus,
we need one random intercept for each stimulus (SID), and they are not
identified by being in a particular labs. Thus: <code>(1|SID)</code></p>
<p>To set it up, we simply need to specify 3 clustering variable,
<em>LABS</em>, <em>PID</em> and <em>SID</em> and their variances in the
model.</p>
<pre><code>y~1*1+1*cond+(1*1|LAB)+(1*1|LAB:PID)+(1*1|SID)</code></pre>
<p>Now we focus on clusters size. We have 10 labs, each labs is
“measured” once (there is only one experiment per lab). Thus
<code># Cluster levels</code>=10 and <code>N per cluster</code>=1. We
have 20 participants, each participant sees the stimuli 2 times (one per
condition), so we have <code># Cluster levels</code>=20 and
<code>N per cluster</code>=2. Finally, we have 15 stimuli, each stimulus
has one replication (one version), so <code># Cluster levels</code>=15
and <code>N per cluster</code>=1.</p>
<p><img src="examples/mixed/example1/e4.input.1.png" width="697" />
<img src="examples/mixed/example1/e4.input.2.png" width="694" /></p>
<p>This is the resulting sample structure (first rows of the generated
dataset):</p>
<p><img src="examples/mixed/example1/e4.output.2.png" width="452" />
….</p>
<p>It is clear that each lab has all PID (here not visible) and each
participants sees each stimuli twice, in cond=1 and cond=2. To
appreciate the full sample characteristics we can look at the Variable
structure:</p>
<p><img src="examples/mixed/example1/e4.output.1.png" width="392" /></p>
<p>Each participant has 30 observations, because it sees 15 stimuli
twice. Each stimulus is seen by 20 participant twice in 10 labs, so each
stimulus has 400 observations. Within each lab, however, the experiment
implies <span class="math inline">\(20 \cdot 15\)</span> observations,
so each lab has 600 observations. Finally, the 600 observations per lab,
summed across 10 labs, yields 6000 observations in total.</p>
</div>
<div id="apparently-fully-nested-desings" class="section level3">
<h3>Apparently fully nested desings</h3>
<p>Now consider a design that is structurally very similar to the one
above. We have 10 labs (<em>LAB</em>) , each lab conducts an experiment
with with 20 participants (<em>PID</em>), each responding to 15 stimuli
(<em>SID</em>). The difference here is that we have that each lab uses
different stimuli. As an example, assume the stimuli are words and that
the labs are located in different regions where different languages are
used. Everything is the same as above, but each stimulus is uniquely
identified by being in a particular lab. Therefore, its random block is:
<code>(1|LAB:SID)</code>. This means that we are estimating one random
intercept (or whatever random coefficient) per stimulus in each lab. In
other words, in the previous example <em>LAB</em> random intercept
variance was computed on 15 coefficients, now is computed on 150
coefficients.</p>
<p>Let’s do it.</p>
<pre><code>y~1*1+1*cond+(1*1|LAB)+(1*1|LAB:PID)+(1*1|LAB:SID)</code></pre>
<p><img src="examples/mixed/example1/e4.input.1.png" width="697" />
<img src="examples/mixed/example1/e4.input.2.png" width="694" /></p>
<p><img src="examples/mixed/example1/e4.output.2.png" width="452" />
….</p>
<p>So far nothing changed in the results as comapred with the previous
example. However, the structure is different.</p>
<p><img src="examples/mixed/example1/e4.output.3.png" width="440" /></p>
<p>Each participant has still 30 observations, because it sees 15
stimuli twice. Each stimulus is seen by 20 participant twice in only one
lab, so each stimulus has 40 observations. Within each lab the
experiment implies <span class="math inline">\(20 \cdot 15\)</span>
observations, so each lab has 600 observations. Finally, the 600
observations per lab, summed across 10 labs, yields again 6000
observations in total.</p>
</div>
</div>
<div id="additional-material" class="section level1">
<h1>Additional material</h1>
</div>
<div id="examples" class="section level1 adm adm-seealso">
<h1>Examples</h1>
<p>
Some worked out practical examples can be found here
</p>
</div>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./mixed.html">Mixed models</a>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/pamlj/pamlj//issues " target="_blank"> PAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
